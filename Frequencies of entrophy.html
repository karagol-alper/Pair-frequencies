<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2487.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="en"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;title&gt;Sequence Analysis and Pairwise frequencies&lt;/title&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.jsdelivr.net/npm/chart.js"&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;style&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>body {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-family: Arial, sans-serif;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>max-width: 800px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin: 0 auto;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #f0f8ff; /* Light blue background */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.sequence-input {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-bottom: 10px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.sequence-input input {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 5px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-size: 16px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>#results {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-top: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>canvas {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>max-width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>#fileUpload {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-bottom: 10px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;h1&gt;Sequence Analysis and Pairwise Frequencies&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div id="fileUpload"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label for="clustalFile"&gt;Upload Clustal Alignment File:&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;input type="file" id="clustalFile" accept=".aln,.txt"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div id="sequenceInputs"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="sequence-input"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;label for="sequence1"&gt;Sequence 1:&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;input type="text" id="sequence1" name="sequence1"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="sequence-input"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;label for="sequence2"&gt;Sequence 2:&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;input type="text" id="sequence2" name="sequence2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;button id="addSequence"&gt;Add Sequence&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;button id="submit"&gt;Submit&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div id="results"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;h2&gt;Results&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="waveFunction"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;canvas id="waveFunctionPlot"&gt;&lt;/canvas&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;button id="download" style="display: none;"&gt;Download Results&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Global variables</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let sequenceCount = 2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>let chart;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Function to add a new sequence input</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function addSequenceInput() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>sequenceCount++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newInput = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>newInput.className = 'sequence-input';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>newInput.innerHTML = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;label for="sequence${sequenceCount}"&gt;Sequence ${sequenceCount}:&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;input type="text" id="sequence${sequenceCount}" name="sequence${sequenceCount}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('sequenceInputs').appendChild(newInput);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Function to validate input sequences</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function validateSequences(sequences) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (sequences.length &lt; 2) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>alert('Please enter at least two sequences.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const length = sequences[0].length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (let i = 1; i &lt; sequences.length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (sequences[i].length !== length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>alert('All sequences must have the same length.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Function to calculate amino acid frequencies</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function calculateFrequencies(sequences) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const length = sequences[0].length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const frequencies = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (let i = 0; i &lt; length; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const columnFreq = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>for (const seq of sequences) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const aa = seq[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>columnFreq[aa] = (columnFreq[aa] || 0) + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>frequencies.push(columnFreq);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return frequencies;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Function to generate wave function</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function generateWaveFunction(frequencies) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return frequencies.map((freq, index) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const totalAA = Object.values(freq).reduce((sum, count) =&gt; sum + count, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const entropy = Object.values(freq).reduce((sum, count) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const p = count / totalAA;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return sum - p * Math.log2(p);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return { x: index + 1, y: entropy };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Function to create plot</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function createPlot(waveFunction) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const ctx = document.getElementById('waveFunctionPlot').getContext('2d');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (chart) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>chart.destroy();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>chart = new Chart(ctx, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>type: 'line',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>data: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>datasets: [{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>label: 'Sequences',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>data: waveFunction,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>borderColor: 'rgb(75, 192, 192)',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>tension: 0.1</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>options: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>responsive: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>scales: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>x: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>type: 'linear',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>position: 'bottom',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>title: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>display: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>text: 'Position'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>y: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>title: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>display: true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>text: 'Entropy'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Function to handle form submission</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function handleSubmit() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const sequences = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (let i = 1; i &lt;= sequenceCount; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const seq = document.getElementById(`sequence${i}`).value.toUpperCase();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (seq) sequences.push(seq);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!validateSequences(sequences)) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const frequencies = calculateFrequencies(sequences);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const waveFunction = generateWaveFunction(frequencies);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('waveFunction').textContent = JSON.stringify(waveFunction);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>createPlot(waveFunction);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('download').style.display = 'block';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Function to download results</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function downloadResults() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const waveFunctionData = document.getElementById('waveFunction').textContent;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(waveFunctionData);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const downloadAnchorNode = document.createElement('a');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>downloadAnchorNode.setAttribute("href", dataStr);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>downloadAnchorNode.setAttribute("download", "wave_function.json");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.body.appendChild(downloadAnchorNode);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>downloadAnchorNode.click();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>downloadAnchorNode.remove();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>html2canvas(document.getElementById('waveFunctionPlot')).then(function(canvas) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const link = document.createElement('a');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>link.download = 'wave_function_plot.png';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>link.href = canvas.toDataURL();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>link.click();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Function to parse Clustal alignment file</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function parseClustalFile(content) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const lines = content.split('\n');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const sequences = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let currentSequence = '';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>for (const line of lines) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (line.trim() === '' || line.startsWith('CLUSTAL')) continue;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const parts = line.trim().split(/\s+/);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (parts.length &gt;= 2) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const [name, sequence] = parts;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (!sequences[name]) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>sequences[name] = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>sequences[name] += sequence;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>currentSequence = name;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else if (currentSequence &amp;&amp; line.trim()) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>sequences[currentSequence] += line.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return Object.values(sequences);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Function to handle file upload</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function handleFileUpload(event) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const file = event.target.files[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!file) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const reader = new FileReader();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>reader.onload = function(e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const content = e.target.result;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const sequences = parseClustalFile(content);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Clear existing sequence inputs</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById('sequenceInputs').innerHTML = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>sequenceCount = 0;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>// Add new sequence inputs with parsed sequences</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>sequences.forEach((seq, index) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>addSequenceInput();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>document.getElementById(`sequence${index + 1}`).value = seq;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>reader.readAsText(file);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Event listeners</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>document.getElementById('addSequence').addEventListener('click', addSequenceInput);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>document.getElementById('submit').addEventListener('click', handleSubmit);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>document.getElementById('download').addEventListener('click', downloadResults);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>document.getElementById('clustalFile').addEventListener('change', handleFileUpload);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
